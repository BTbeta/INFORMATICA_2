/**************************************
 *zeng oscar                          *
 *4H                                  *
 *10/10/2022                          *
 *esercizio in classe :record         *
 **************************************/
//inclusione di librerie
#include<stdio.h>					//utilizato per input e output
#include<stdlib.h>					//utilizato per srand e system
#include<time.h>					//utilizato per rand
#include<limits.h>					//utilizato per INT_MIN nella funzione TrovaVotoAlto
#include<strings.h>					//utilizato per strcmp e strcpy nella funzione Ordine_Cognome
//inclusione dei costanti
#define N 3							//numero di studebti	
#define V 5							//quanti voti
#define L 10						//lunghezza delle parole
//dichiarazione struct
struct data
{
	int gg;
	char mm[L];
	int aaaa;
}typedef data;
struct student
{
	int matricola;					//numero in classifica
	char cognome[L];
	data nascita;
	int voti[V];
	int media;
}typedef student;
//dichiarazione funzioni
void InsrimentoRandVoti(student[]);
void visualizza(student[]);
void media_studente(student []);
int TrovaVotoAlto(student[]);
void M_cog(student[]);
int RicercaMatricola(student[]);
int RicercaCognome(student[]);
void Ordine_Cognome(student[]);
//programma principale
int main()
{
	int a;							//a utilizzato per prendere i valori dai funzioni
	student st[N];
	srand(time(NULL));
	InsrimentoRandVoti(st);
	M_cog(st);
	visualizza(st);
	media_studente(st);
	a=TrovaVotoAlto(st);
	printf("%s\n",st[a].cognome);
	system("pause");
	system("cls");
	a=RicercaMatricola(st);
	printf("%d\n",a);
	system("pause");
	system("cls");
	a=RicercaCognome(st);
	printf("%d\n",a);
	system("pause");
	system("cls");
	Ordine_Cognome(st);
	visualizza(st);
}
void InsrimentoRandVoti(student st[])
{
	int i,j,t=0,m;
	for(j=0;j<N;j++)
	{
		printf("inserisci informazioni studente %d\n",j+1);
		printf("matricola\n");
		scanf("%d",&st[j].matricola);
		printf("cognome\n");
		scanf("%s",st[j].cognome);
		printf("data di nascita\n");
		printf("giorno\n");
		scanf("%d",&st[j].nascita.gg);
		printf("nome mese\n");
		scanf("%s",st[j].nascita.mm);
		printf("anno\n");
		scanf("%d",&st[j].nascita.aaaa);
		for(i=0;i<V;i++)
		{
			st[j].voti[i]=rand()%10+1;
			t+=st[j].voti[i];
		}
		m=t/V;
		st[j].media=m;
		t=0;
		m=0;
		system("cls");
	}
}
void visualizza(student st[])
{
	int i,j;
	for(j=0;j<N;j++)
	{
		printf("informazioni studente %d\n",j+1);
		printf("matricola\n");
		printf("%d\n",st[j].matricola);
		printf("cognome\n");
		printf("%s\n",st[j].cognome);
		printf("data di nascita\n");
		printf("giorno\n");
		printf("%d\n",st[j].nascita.gg);
		printf("mese\n");
		printf("%s\n",st[j].nascita.mm);
		printf("anno\n");
		printf("%d\n",st[j].nascita.aaaa);
		printf("voti\n");
		for(i=0;i<V;i++)
		{
			printf("%d\t",st[j].voti[i]);
		}
		printf("\nmedia\n");
		printf("%d\n",st[j].media);
	}
	system("pause");
	system("cls");
}
void media_studente(student st[])
{
	int j;
	for(j=0;j<N;j++)
	{
		printf("informazioni studente %d\n",j+1);
		printf("cognome\n");
		printf("%s\n",st[j].cognome);
		printf("media\n");
		printf("%d\n",st[j].media);
	}
	system("pause");
	system("cls");
}
int TrovaVotoAlto(student st[])
{
	int i,j,v[N+1],r;
	for(j=0;j<N+1;j++)
	{
		v[j]=INT_MIN;
	}
	for(j=0;j<N;j++)
	{
		for(i=0;i<V-1;i++)
		{
			if(v[j]<st[j].voti[i])
			v[j]=st[j].voti[i];
		}
	}
	for(i=0;i<N-1;i++)
	{
		if(v[N]<v[i])
		v[N]=v[i];
		r=i;
	}
	return r;
}
void M_cog(student st[])
{
	int i,j;
	for(j=0;j<N;j++)
	{
		i=0;
		if(st[j].cognome[i]>='a'&&st[j].cognome[i]<='z')
		{
			st[j].cognome[i]-=32;
		}
		i++;
		do
		{
			if(st[j].cognome[i]>='A'&&st[j].cognome[i]<='Z')
			{
				st[j].cognome[i]+=32;
			}
			i++;
		}while(st[j].cognome[i]!='\0');
	}
}
int RicercaMatricola(student st[])
{
	int j,a;
	printf("insrisci la numero matricola\n");
	scanf("%d",&a);
	system("cls");
	for(j=0;j<N;j++)
	{
		if(st[j].matricola==a)
		{
			return j;
		}
	}
	return -1;
}
int RicercaCognome(student st[])
{
	int i=0;
	char a[L];
	printf("insrisci il cognome\n");
	scanf("%s",a);
	system("cls");
	if(a[i]>='a'&&a[i]<='z')
	{
		a[i]-=32;
	}
	i++;
	do
	{
		if(a[i]>='A'&&a[i]<='Z')
		{
			a[i]+=32;
		}
		i++;
	}while(a[i]!='\0');
	for(i=0;i<N;i++)
	{
		if(strcmp(st[i].cognome,a)==0)
		{
			return i;
		}
	}
	return -1;
}
void Ordine_Cognome(student st[])
{
	student st2;
	int i,s;
	do
	{
		s=0;
		for(i=0;i<N-1;i++)
		{
			if(strcmp(st[i].cognome,st[i+1].cognome)==1)
			{
				st2=st[i];
				st[i]=st[i+1];
				st[i+1]=st2;
				s=1;
			}
		}
	}while(s==1);
}
